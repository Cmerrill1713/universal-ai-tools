{
  "timestamp": "2025-07-20T02:10:45.426Z",
  "overallScore": 14,
  "results": {
    "vulnerabilities": [],
    "securityHeaders": [
      {
        "header": "x-content-type-options",
        "present": false,
        "value": "Not set",
        "passed": false,
        "recommendation": "Set x-content-type-options header"
      },
      {
        "header": "x-frame-options",
        "present": false,
        "value": "Not set",
        "passed": false,
        "recommendation": "Set x-frame-options header"
      },
      {
        "header": "x-xss-protection",
        "present": false,
        "value": "Not set",
        "passed": false,
        "recommendation": "Set x-xss-protection header"
      },
      {
        "header": "strict-transport-security",
        "present": false,
        "value": "Not set",
        "passed": false,
        "recommendation": "Set strict-transport-security header"
      },
      {
        "header": "content-security-policy",
        "present": false,
        "value": "Not set",
        "passed": false,
        "recommendation": "Set content-security-policy header"
      },
      {
        "header": "referrer-policy",
        "present": false,
        "value": "Not set",
        "passed": false,
        "recommendation": "Set referrer-policy header"
      }
    ],
    "inputValidation": [
      {
        "test": "Script injection in body",
        "status": 404,
        "passed": false,
        "details": "Expected: sanitized, Got: 404"
      },
      {
        "test": "SQL injection attempt",
        "status": 404,
        "passed": false,
        "details": "Expected: blocked, Got: 404"
      },
      {
        "test": "Path traversal in parameters",
        "status": 404,
        "passed": false,
        "details": "Expected: blocked, Got: 404"
      },
      {
        "test": "Oversized payload",
        "status": 500,
        "passed": false,
        "details": "Expected: rejected, Got: 500"
      },
      {
        "test": "Null byte injection",
        "status": 404,
        "passed": false,
        "details": "Expected: sanitized, Got: 404"
      }
    ],
    "authentication": [
      {
        "test": "No API key provided",
        "status": 404,
        "passed": false,
        "details": "Expected: 401, Got: 404"
      },
      {
        "test": "Invalid API key",
        "status": 404,
        "passed": false,
        "details": "Expected: 401, Got: 404"
      },
      {
        "test": "Missing AI service header",
        "status": 404,
        "passed": false,
        "details": "Expected: 401, Got: 404"
      },
      {
        "test": "Valid credentials (development)",
        "status": 404,
        "passed": false,
        "details": "Expected: 200, Got: 404"
      }
    ],
    "apiSecurity": [
      {
        "test": "CORS policy enforcement",
        "passed": true,
        "details": "Test pass"
      },
      {
        "test": "HTTP method validation",
        "passed": false,
        "details": "Test fail"
      },
      {
        "test": "Request size limits",
        "passed": false,
        "details": "Test fail"
      },
      {
        "test": "Rate limiting enforcement",
        "passed": false,
        "details": "0/10 requests rate limited"
      }
    ],
    "systemSecurity": [
      {
        "test": "Environment variable exposure",
        "passed": false,
        "details": "Error: Unexpected token '<', \"<!DOCTYPE \"... is not valid JSON"
      },
      {
        "test": "Error message information leakage",
        "passed": true,
        "details": "Test pass"
      },
      {
        "test": "Health endpoint security",
        "passed": true,
        "details": "Test pass"
      }
    ],
    "overallScore": 14,
    "recommendations": [
      "Fix: Script injection in body - Expected: sanitized, Got: 404",
      "Fix: SQL injection attempt - Expected: blocked, Got: 404",
      "Fix: Path traversal in parameters - Expected: blocked, Got: 404",
      "Fix: Oversized payload - Expected: rejected, Got: 500",
      "Fix: Null byte injection - Expected: sanitized, Got: 404",
      "Fix: No API key provided - Expected: 401, Got: 404",
      "Fix: Invalid API key - Expected: 401, Got: 404",
      "Fix: Missing AI service header - Expected: 401, Got: 404",
      "Fix: Valid credentials (development) - Expected: 200, Got: 404",
      "Fix: undefined - undefined",
      "Fix: undefined - undefined",
      "Fix: undefined - undefined",
      "Fix: undefined - undefined",
      "Fix: undefined - undefined",
      "Fix: undefined - undefined",
      "Fix: HTTP method validation - Test fail",
      "Fix: Request size limits - Test fail",
      "Fix: Rate limiting enforcement - 0/10 requests rate limited",
      "Fix: Environment variable exposure - Error: Unexpected token '<', \"<!DOCTYPE \"... is not valid JSON",
      "Implement automated security scanning in CI/CD pipeline",
      "Review and update security policies regularly",
      "Conduct regular penetration testing"
    ]
  },
  "summary": {
    "totalTests": 22,
    "passedTests": 3,
    "recommendations": 22
  }
}
